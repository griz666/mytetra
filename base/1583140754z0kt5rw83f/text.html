<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Итак по мере того, как начинаешь пользоваться изучаемым и из просмотра различных видео обзоров встает задача на первый взгляд тривиальная, но не все так легко как может показать на первых взгляд. Сегодня речь пойдет, </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">как используя сервис</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">производить удаленное выключение систем</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> и </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Ubuntu</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">дома</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, где в роли командного устройства выступит Ваш смартфон/планшет под управлением операционной системы </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Android</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> с установленным приложением </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDroid.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="more-12321"></a><span style=" font-family:'Sans Serif'; font-size:9pt;">Ч</span><span style=" font-family:'Sans Serif'; font-size:9pt;">то лень выключить за собой компьютер?, да не ужели для этого нужно думать как сделать это удаленно и главное голосом. Тут можно возразить, лишний опыт никогда не будет лишним, да и пусть работающий сервис </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> выполняет столь важную задачу, как выключение ПК после того, как я ушел из комнаты, ложусь спать и т. д. Главное что данную задачу я решил поставив себе задачу, ведь она практична и полезна. В текущее время смартфон это не просто средство общения, но и полезный друг всей жизни который всегда при Вас, он дает общение, доступ в интернет, развлечения, работу так пусть и будет связующим звеном между Вами и сервисом </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Сервис </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> развернут на базе серии заметок моего </span><a href="https://www.youtube.com/channel/UCDuNWHkUUM16DbQ0jQZ9aFw"><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600; text-decoration: underline; color:#0000ff;">Youtube</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">-канала.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#0000ff;">Шаг №1:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">Чтобы выключить</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows 7 SP1 x86/x64</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">систему в локальной сети</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> (система не в домене, а в локальной группе). Ниже Как я подходил к решению данной задачи.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Сделать </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">PHP</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> скрипт с формой </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">html</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> где я вбиваю </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">IP, User, Password</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> и нажимаю «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Выключить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">» и в ответ удаленный компьютер выключается. Но после от формы я отказался.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo rm -Rf /var/lib/apt/lists</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo apt-get update &amp;&amp; sudo apt-get upgrade -y</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo apt-get install samba-common-bin -y</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff00ff;">На заметку:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> на своем домашнем компьютере я работаю с правами Администратора, </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">UAC</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> включен и обязательно использую связку </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Login + Password</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, а до этого следует нажать сочетание клавиш </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Ctrl + Alt + Del</span><span style=" font-family:'Sans Serif'; font-size:9pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo net rpc shutdown -t 3 -f -C shutdown -U Admin%Aa1234567 -I 10.9.9.96</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">Could not initialise pipe winreg. Error was NT_STATUS_OBJECT_NAME_NOT_FOUND</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Чтобы все таки команда выше отработала нужно на </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> системе сделать следующее:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">включить службу</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Удаленный реестр</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">C:\Windows\system32&gt;sc config RemoteRegistry start= auto</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">C:\Windows\system32&gt;sc start RemoteRegistry</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">выключить профили</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;"> встроенного брандмауера</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">C:\Windows\system32&gt;netsh advfirewall set allprofiles state off</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Пробую еще раз запустить команду с </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Raspberry Pi 3</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> на выключение </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> системы:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo net rpc shutdown -t 3 -f -C shutdown -U Admin%Aa1234567 -I 10.9.9.96</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">Shutdown of remote machine failed</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">result was: WERR_CALL_NOT_IMPLEMENTED</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">В этом случае на </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> системе нужно сделать следующее:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">C:\Windows\system32&gt;reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">Операция успешно завершена.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">C:\Windows\system32&gt;shutdown /r /t 3</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Пробую еще раз запустить команду с </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Raspberry Pi 3</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> на выключение </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> системы:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo net rpc shutdown -t 3 -f -C shutdown -U Admin%Aa1234567 -I 10.9.9.96</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">Shutdown of remote machine succeeded</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Заработало, </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows 7 x86/x64 SP1 Pro</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> успешно выключилась и на экране уведомление что система выключается:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1583140747kzu473nv3m.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">В этом окне можно написать все что необходимо знать пользователю почему его система выключилась.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff00ff;">На заметку:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> И с моим тестовым паролем </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">712mbddr@</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> выключение также происходит.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#0000ff;">Шаг №2:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">Чтобы теперь сервис</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">смог выключить</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">систему нужно проделать следующие настройки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo visudo</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">www-data ALL=(ALL) NOPASSWD:ALL</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">Чтобы сценарий выключения</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">компьютера отработал нужно добавить сценарий:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">http://IP&amp;DNS — Панель управления — (Объекты) Сценарии — Добавить новый сценарий</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Название:</span> <span style=" font-weight:600;">shutdown_windows</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">и нажимаю «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Добавить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">», затем </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Код: PHP</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">$shutdown = shell_exec(&quot;/usr/bin/net rpc shutdown -t 3 -f -C shutdown -U Admin%Aa1234567 -I 10.9.9.96&quot;);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">После нажимаю «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Сохранить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#0000ff;">Шаг №3:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> Теперь когда есть отрепетированные строки </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">выключения</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">системы исполнить задуманную задачу через</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">можно следующими способами:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Либо через «<span style=" font-weight:600;">Шаблон поведения</span>»</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">http://IP&amp;DNS — Панель управления — (Объекты) Шаблоны поведения — Добавить новую запись</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Название:</span> <span style=" font-weight:600;">Выключить ПК</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">нажимаю «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Добавить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Шаблон:</span> <span style=" font-weight:600;">[В^в]ыключить комп</span></li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Выполнить при совпадении: Сценарий:</span> выбираю <span style=" font-weight:600;">shutdown_windows</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">и нажимаю «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Сохранить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Теперь если на главной странице набрать команду: «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">выключить комп</span><span style=" font-family:'Sans Serif'; font-size:9pt;">» и нажать «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Отправить</span><span style=" font-family:'Sans Serif'; font-size:9pt;">», команда успешно отрабатывает и удаленная система указанная в Сценарии выключается.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">либо через приложением «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDroid</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Включаю свой смартфон </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Huawei Honor C5</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, запускаю </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Play Market</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, вбиваю в поиск слово: </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">majordroid</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> и вижу среди найденного несколько одинаково обозванных приложений, я же использую </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDroid (от Artem Galaktionov)</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, устанавливаю его.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">После установки запускаю, тут нужно </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">настроить само приложение</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, перехожу в элемент настройки «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Настройки</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Режим доступа:</span> <span style=" font-weight:600;">Автоматически</span></li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Интерфейс:</span> <span style=" font-weight:600;">Обычный</span></li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Локальный адрес:</span> <span style=" font-weight:600;">10.9.9.161</span></li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Глобальный адрес:</span> как <span style=" font-weight:600;">DNS</span> так и статический IP, я применяю связку Mikrotik + DNS и проброс порта из вне в домашнюю сеть, а потому адрес принимает вид: <a href="http://www.ekzorchik.ru/2017/05/cname-record-for-access-to-mikrotik/"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">home.ekzorchik.ru:23466</span></a> (в реале же URL адрес другой)</li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Домашняя WiFi-сеть:</span> <span style=" font-weight:600;">network</span></li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Логин:</span> <span style=" font-weight:600;">ekzorchik</span> (в реале же логин намного сложнее)</li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Пароль:</span> <span style=" font-weight:600;">712mbddr</span>@ (в реале же пароль намного сложнее)</li>
<li style=" font-family:'Sans Serif'; font-size:9pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#008000;">Привязка кнопок пульта:</span></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#008000;">Кнопка 1</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> → </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">shutdown_windows</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">и если все настройки в программе сделаны корректно, то перейдя на главную страницу приложения </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDroid</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> вы должны увидеть свою страницу, в моем же случае это страница с текущей погодой от сервиса </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">OpenWeatherMap.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1583140747chxtlo6kat.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">если сказать голосом в предварительно выбранное меню с иконкой микрофона слово: «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">выключить пк</span><span style=" font-family:'Sans Serif'; font-size:9pt;">», то отработает «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Шаблон поведения</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">если перейти в меню с иконкой изображенного пульта и нажать на кнопку </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">1</span><span style=" font-family:'Sans Serif'; font-size:9pt;">, то отработает «</span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Скрипт</span><span style=" font-family:'Sans Serif'; font-size:9pt;">»</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Итого: Задача по удаленному выключению домашнего ПК через сервис </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">MajorDoMo</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> выполнена.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff00ff;">На заметку:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> Важно чтобы на учетную запись </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> обладающую правами локального администратора был установлен логин и пароль</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#0000ff;">Шаг №4:</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">Как с</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Raspbian Jessie</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">выключить домашнюю</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Ubuntu Trusty Desktop</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> (настроен </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">AutoLogon</span><span style=" font-family:'Sans Serif'; font-size:9pt;">) </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">станцию через</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">PHP</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">скрипт:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ sudo apt-get install sshpass -y</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">перезагрузить систему:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ /usr/bin/sshpass -p 712mbddr@ ssh -o StrictHostKeyChecking=no ekzorchik@10.9.9.108 'echo 712mbddr@ | sudo -S shutdown -r now'</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; color:#ff0000;">выключить систему:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">pi@raspberrypi:~ $ /usr/bin/sshpass -p 712mbddr@ ekzorchik@10.9.9.108 'echo 712mbddr@ | sudo -S poweroff'</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">и с учетом все этого, </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">PHP</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> скрипт будет следующим и делается он по аналогии, как я выключал </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Windows</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> станцию.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">say(&quot;Выключаю домашний компьютер&quot;,2);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt; color:#008000;">$shutdown = shell_exec(&quot;/usr/bin/sshpass -p 712mbddr@ ssh -o StrictHostKeyChecking=no ekzorchik@10.9.9.108 'echo 712mbddr@ | sudo -S shutdown -r now'&quot;);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">10:07 Алиса: Выключаю домашний компьютер<br />10:07 Admin: выключить компьютер</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Не спорю, что данную задачу можно дополнить такими шагами, как проверка что компьютер выключен, есть ли связь с данным компьютером, отработала ли команда т. д. Если кому надо, то он уже сам должен разобраться с этим.</span></p></body></html>