<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">Не работает wake on lan в linux, как настроить</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://serveradmin.ru/author/zerox/"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">Zerox </span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">Обновлено: 08.08.2019 </span><a href="https://serveradmin.ru/category/poleznyie-sovetyi/"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">Полезные советы</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> </span><a href="https://serveradmin.ru/ne-rabotaet-wake-on-lan-v-linux-kak-nastroit/#comments"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">10 комментариев</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> 957 Просмотры</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">После недавнего </span><a href="https://serveradmin.ru/obnovlenie-proxmox-5-do-6/"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">обновления proxmox до 6-й версии</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;"> перестал работать WoL. Это технология wake on lan для запуска компьютера через сеть. Я использую proxmox для тестовых целей, поэтому ему не обязательно постоянно работать. Я сделал скрипт в </span><a href="https://serveradmin.ru/mikrotik/"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">mikrotik</span></a><span style=" font-family:'Sans Serif'; font-size:9pt;">, с помощью которого удаленно запускаю гипервизор в случае необходимости и пользуюсь им. Потом завершаю работу.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Если у вас есть желание научиться строить и поддерживать высокодоступные и надежные системы, рекомендую познакомиться с </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-weight:600;">онлайн-курсом «Администратор Linux»</span><span style=" font-family:'Sans Serif'; font-size:9pt;"> в OTUS. Курс не для новичков, для поступления нужно пройти </span><a name="revive-0-1"></a><a href="https://serveradmin.ru/asr/www/del/ck.php?oaparams=2__banaid=41__zoid=23__cb=6e80c1cf06__oadest=https%3A%2F%2Fserveradmin.ru%2Fotus-linux-text"><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">в</span></a><span style=" font-family:'Sans Serif'; font-size:9pt; text-decoration: underline; color:#0000ff;">ступительный тест</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1578780201ax65fm3mkw.png" /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="more-9387"></a><span style=" font-family:'Sans Serif'; font-size:9pt;">П</span><span style=" font-family:'Sans Serif'; font-size:9pt;">осле обновления wake on lan работать перестал. Я уже подзабыл, как его настраивал до этого и настраивал ли, поэтому сейчас решил записать, чтобы не забыть. Итак, чтобы работал wake on lan в linux, у вас должна быть включена такая возможность в BIOS. Но этого не всегда достаточно.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Идем в консоль системы и там выполняем команду:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"># ethtool -s enp5s0 wol g</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Если ethtool не установлен, то ставите его командой:</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;"># apt install ethtool</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">enp5s0 — сетевой интерфейс, который смотрит в локалку и находится в одном сегменте сети с mikrotik. Последний видит его mac адрес. Далее добавляем в </span><span style=" font-family:'Sans Serif'; font-size:9pt; font-style:italic;">/etc/network/interfaces</span><span style=" font-family:'Sans Serif'; font-size:9pt;">:</span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">iface enp5s0 inet manual</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'monospace'; font-size:9pt;">	</span><span style=" font-family:'monospace'; font-size:9pt; font-weight:600;">ethernet-wol g</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'monospace'; font-size:9pt; font-weight:600;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">Все, теперь wake on lan будет нормально работать и сервер можно будет включать удаленно. На mikrotik у меня вот такой скрипт.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1578780201lfka71pmtr.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans Serif'; font-size:9pt;">00:25:22:DC:39:42 — mac адрес сетевого интерфейса enp5s0 сервера. В итоге, если нужен тестовый сервер, подключаюсь по vpn к mikrotik, там запускаю proxmox, виртуальные машины. Они все доступны через vpn. Когда сделаю, все, что нужно, выключаю сервер.</span></p></body></html>