<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://en.community.sonos.com/members/todd-sonos-18086"><span style=" text-decoration: underline; color:#000000;">Todd - Sonos </span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Sonos Employee </li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">173 replies </li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">I wanted to post a few clarifications regarding SONOS and Spanning Tree Protocol that have been raised in this thread.<br /><br />SONOS ZonePlayers use 802.1D Spanning Tree (STP) for loop prevention between wired ZonePlayers and the wireless SonosNet Mesh Network. The Spanning Tree running on ZonePlayers is compliant with IEEE 802.1D and can inter-operate with other IEEE 802.1D and IEEE 802.1w compliant devices. Note: IEEE 802.1w is an updated version of the Spanning Tree protocol called Rapid Spanning Tree. The two types of STP protocols are compatible and 802.1w should revert to inter-operate with 802.1D devices (such as Sonos). Therefore, 802.1w Ethernet switches will work with Sonos ZonePlayers.<br /><br />SONOS ZonePlayers CAN be connected to Ethernet switches that do NOT support Spanning Tree as long as the Ethernet switches do not interfere with the STP BPDU packets transmitted between ZonePlayers. This is typically never the case and these switches pass the BPDU packets like any other packet.<br /><br />If the Ethernet switches that Sonos ZonePlayers are wired to DOES support Spanning Tree, the Spanning Tree on those switches must be configured properly. Ethernet switches that support Spanning Tree typically have their STP settings disabled. This also typically means that these switches will block/discard the BPDUs coming from the ZonePlayers. When the ZonePlayers are not able to see BPDUs, they cannot detect there is a shared transmission medium between the Zones and this will typically result in loops in the network. The solution to allow the use of these switches with Sonos is to enable and configure the Spanning Tree on the Ethernet switches. The configuration settings on each switch are different and the appropriate documentation for those products should be consulted. Note: Some switches have a setting that is called Pass BPDUs or equivalent. This setting when present allows the BPDUs between the ZonePlayers to pass freely through the switch without actually enabling STP on the the switch. Typically, setting this function also works, but again please review the switches product documentation. <br /><br />A good guideline for Ethernet switches is if the switch says it supports Spanning Tree, either 802.1D or 802.1w, then its configuration settings and user documentation should be examined before wiring multiple ZonePlayers to the switch. If the switch does not state it supports Spanning Tree, 802.1D, or 802.1w, it will probably work fine with Sonos.<br /><br />SONOS ZonePlayers do NOT require a connection to the same Ethernet switch. Different ZonePlayers can be connected to different Ethernet switches which are in turn connected to each other. The only requirement is that Sonos ZonePlayers must be able to actively participate in 802.1D Spanning Tree and not have BPDU transmission blocked between them. There is no Sonos limitation that prevents wiring multiple ZonePlayers to multiple Ethernet switches.<br /><br />IEEE 802.1D has a recommended bridge span limitation of 7 bridges. This means that the total number of connected bridges from one end of the network to the other should not exceed 7 bridges. This typically only comes into play when daisy chaining Sonos ZonePlayers together by wiring one ZonePlayer to the next. In this case, the guidelines is when daisy chaining ZonePlayers, do not exceed 7 ZonePlayers wired together. If wiring multiple ZonePlayer to a single Ethernet switch, typically the number of spans will only be 3 or 4 (I.e. much less than 7). Except in the daisy-chain configuration, this limit of 7 bridges/7 ZonePlayers, is rarely ever hit.<br /><br />A number of comments have used the term router and switch interchangeably in regards to this topic. Sonos ZonePlayers in the same HouseHold MUST be connected to the same routed network. A Spanning Tree cannot span two or more routed networks. In addition all Sonos ZonePlayers and Controllers must be on the same routed IP network in order to properly communicate and function. Typically, two or more routed networks are not seen in the household environment except by accident (Example. A carrier provides a new router in a network that already had a router and the original router was not removed).<br /><br />Hopefully this information has clarified a number of items and not added additional confusion.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">*************************************</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Hi,<br /><br />for everyone running a network with multiple STP-capable core switches, e. g. HP Procurve, it might be interesting to know, that Sonos has not implemented path costs of links according to the current standard 802.1t, but still uses 802.1D.<br /><br />Current switches use path costs of 200,000 for an 100B-T interfaces, whereas Sonos still uses 10 (for a full-duplex 100B-T)<br /><a href="http://en.wikipedia.org/wiki/Spanning_tree_protocol#Data_rate_and_STP_path_cost"><span style=" text-decoration: underline; color:#0000ff;">http://en.wikipedia.org/wiki/Spanning_tree_protocol#Data_rate_and_STP_path_cost</span></a><br /><br />Everyone affected will have Sonos zone players use a Sonos wireless cascade to the elected root switch, even if the core switches have a Gigabit-Link (at current 802.1t path costs of 20,000)! This leads to a cascaded load over possibly weak wireless links.<br /><br />Workaround:<br /><br />Manually configure trunk connections between core switches at path cost 10. If done so, the Sonos zoneplayers will use the nearest wired connection!<br /><br />Wish list:<br /><br />Sonos is encouraged to use the current standard 802.1t for path cost to avoid problems with switch trunks in current standard configurations. </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">***********************</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Andy Urtu;119998Â wrote:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">I called Sons support today. I had purchased a new ZoneBridge to help coverage in my house. <br /><br />I set the ZoneBridge as the wired main hub. As I added th ZP back one by one, all was great except for one ZP80. The network kept setting the ZP80 as the rootbridge, which negated the new Bridge.<br /><br />The procedure Sonos walked me through:<br /><br />1. HTTP to the rootbridge you want to remove and root. http://#.#.#.#:1400/advconfig.htm<br /><br />2. Set the &quot;FirstZP:&quot; field to <span style=" font-weight:600;">disabled</span><br />Click SUBMIT<br /><br />3 Now HTTP to the Zone Player you want to be Root. http://#.#.#.#:1400/advconfig.htm<br /><br />4. 2. Set the &quot;FirstZP:&quot; field to <span style=" font-weight:600;">enabled</span><br />Click SUBMIT<br /><br />5. Also be sure to reboot both of the units after they have been been properly configured using the power cable, or by attaching /reboot to the ZP url.<br /><br />If you ever see more than one 'Root Bridge' in the network matrix, be sure to turn one of the zones root bridge setting off. Also be sure to reboot both of the units after they have been been properly configured using the power cable, or by attaching /reboot to the zp url.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">***************************</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Mr Sonos,<br />Could you please set your default bridge priority to something really high?<br />Because Sonos MAC addresses start with 00:0E they are pretty much always the lowest MAC and will win the BRIDGE PRIORITY BATTLE by default which will lead to issues in the network because the switches will do what the Sonos tells them.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>